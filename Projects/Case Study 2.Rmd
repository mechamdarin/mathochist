---
title: "Case Study - BF[2]"
author: Darin Mecham
output: 
  html_document:
    theme: cerulean
    code_folding: hide
---

```{r, include = FALSE}
library(readr)
library(pander)
library(agricolae)
library(car)
library(tidyverse)
library(mosaic) 
```

# Ballistics with Balloons

## Introduction

Summer is approaching!! An essential component of summer is a water balloon fight. This study will be examining how the size of a water balloon as well as the distance at which it is thrown affects the splash radius of the impact. This way, by reading this study, you can see if there really is a best size of water balloon. Another thing that can be obtained is how close do you have to be to get the MAXIMUM SPLASH. 

**Response** - The size of the splash mark caused by the water balloon (measured from the center of the rough circle).
  
*Side note:* the radii will be recorded in the dataset, there will be a separate column for the area. The AREA of the splash mark will be the response

(Both will be recorded in centimeters/centimeters squared)

**Treatments** - This study will employ two treatment factors. Those treatment factors are the distance at which they are thrown and the size of the balloon.

  Distances - 5 meters, 8 meters, and 11 meters 

  Sizes - 50 cubic centimeters, 100 cubic centimeters, and 150 cubic centimeters
(Volumes of the various sizes)

**Units** - the water balloons 

## Experimental Protocol

1. Gather the materials required. For this experiment, you will need: water balloons, plain white T-shirts, food coloring (to differentiate between sizes), a place where you can set up a straight shot, markers (to mark the distance), (in order to get an exact volume) syringes, and, of course, WATER!!

2. The first step after gathering the materials will be to randomly assign balloons to the different size categories (This will be done using a random number generator). To clarify, the size categories will be numbered 1-3 and the balloons will be assigned to one of the three groups.

3. The second step will be to assign a distance to it. This will be done in a similar fashion to the previous step. Except that the groups will already be split into sizes.

4. Make it so that all of the possible combinations have five balloons in each. 

5. Fill the balloons with the water. In order to differentiate between the sizes and their impacts, use food coloring to color the water of the different sizes. Personally, I will be using the primary colors (blue for large balloons, yellow for medium balloons, and red for small balloons). 

6. Set up the straight shot by setting up markers along the way at 5 meters, 8 meters, and 11 meters. To do this, use a piece of plywood (or other flat surface) and attach the shirt in some way. Personally, I found a piece of plywood that was narrow enough that I could slip the shirt over it.  

7. Throw the balloons at the respective distances (try to use the same amount of force for each throw)

8. After each throw, take a measuring device and measure from the center of each impact. Preferably, measure from the approximate center to the edge that is on the shirt. Because of human accuracy, it may be difficult to have an accurate measurement (could end up hitting near one of the edges of the shirt). Record the radius of the circle.

## Hypotheses

For the purposes of this experiment, I will be using the following mathematical model:

In this model:

* $\Y$ represents the observed value

* $\mu$ represents the grand mean

* $\alpha$ represents the effect of the size

* $\beta$ represents the effect of the distance

* $\alpha$$\beta$ represents the effect of the interaction of the size and distance

* $\epsilon$ represents the residual error of each term

$$
Y_\text{ijk} = \mu + \alpha_i + \beta_j + (\alpha\beta)_\text{ij} + \epsilon_\text{ijk} 
$$

The hypotheses for this test are as follows. Starting with the sizes. Note that the alpha and beta below are the same as the ones that were defined with the model. 

$$
H_0: \alpha_1 = \alpha_2 = \alpha_3 = 0
$$

$$
H_a: \alpha_i \neq 0
$$
$$
\text{For at least one i}
$$


Second, for the distance:

$$
H_0: \beta_1 = \beta_2 = \beta_3 = 0
$$

$$
H_a: \beta_j \neq 0
$$

$$
\text{For at least one j}
$$


The interaction of size and distance:

$$
H_0: \text {The effect of the size is the same for all of the distances}
$$
$$
H_a: \text {The effect of the size is different for at least one of the distances}
$$

The signifance level that will be used is **0.05**

## Sources of variation

1. Because I am only human, the water balloons will not be exactly the size that I want them to be. I hope that any sort of variation that results will not mess up the results too badly.

2. Because of the expense of purchasing multiple shirts, I will be using the same shirt for many tosses. The colored water could bleed and mess up the measurement, effectively destroying the measurement. In order to avoid as much of this effect as possible, I will be switching out the shirt after shot and letting the shirt dry. That way, the water won't bleed as much (I hope). 

3. Once again, I am only human. As a result of this, it is likely that the throws will be different in some way, shape, or form. This could disrupt the splash radius in some way. I will try to replicate each throw so that this effect is not as prominent. 

4. The shot order will end up being haphazard. This could greatly affect the measurements. I will try to do my best and let the shirts dry after each shot. 


## Data 


```{r, message = FALSE, warning = FALSE}
Balloons <- read_csv("Data/Water Balloons.csv")
Balloons$Size <- as.factor(Balloons$Size)
Balloons$Distance <- as.factor(Balloons$Distance)
Balloons$Balloon <- as.character(Balloons$Balloon)
pander(Balloons)
balloons.aov <- aov(Area ~ Size*Distance, data = Balloons, contrasts = list(Size = contr.sum, Distance = contr.sum))
```


### Effects

```{r, message = FALSE, warning = FALSE}
pander(balloons.aov$coefficients, caption = "Effect Sizes of Data")
```


### Diagnostic Plots

```{r, warning = FALSE, message = FALSE}
par(mfrow = c(1,2))
plot(balloons.aov, which = 1:2)
```


## Test and Analysis

```{r, warning = FALSE, message = FALSE}
pander(summary(balloons.aov), caption = "Two Way ANOVA Test Results")
```

It can clearly be seen that the results of these tests are all significant. Since the interaction factor is significant, the individual factors should not be interpreted. The null hypothesis that the effect of the size is the same for all of the distances is rejected at the 0.05 significance level. Therefore, there is sufficient evidence that the effect of the size is different for at least one of the distances. 


### Interaction Plot

```{r, warning = FALSE, message = FALSE}
interaction.plot(Balloons$Size, Balloons$Distance, Balloons$Area, xlab = "Size of the Balloon (in mL)", ylab = "Mean of Area of Splash Circle")
```

As it can be seen in this interaction plot, there appears to be no sections where the lines are parallel. An argument could be made for some parts of it, but it doesn't seem to be enough to show a complete lack of interaction. 


## Conclusion

At the end of this, there were several things that could've been better with this experiment. The response variable could've been changed into something more convenient and measured in a better fashion. Judging by the diagnostic plots, this test should not be trusted. The constant variance requirement appears to be violated and the QQ plot isn't pretty either. 


## Logaritmic What-if

This data had issues with it. Neither the QQ nor the Residuals vs. Fitted plot looked pretty. In this section, I will be performing a log transformation on this dataset to see if that has an effect on the validity of this test and the test in general.

```{r, message = FALSE, warning = FALSE}
balloons.aov.log <- aov(log(Area) ~ Size*Distance, data = Balloons, contrasts = list(Size = contr.sum, Distance = contr.sum))
```

```{r, warning = FALSE, message = FALSE}
par(mfrow = c(1,2))
plot(balloons.aov.log, which = 1:2)
```

```{r, warning = FALSE, message = FALSE}
pander(summary(balloons.aov.log), caption = "Two Way ANOVA Test Results (Area logged)")
```

```{r, warning = FALSE, message = FALSE}
pander(balloons.aov.log$coefficients, caption = "Effect Sizes of Logged Data")
```

The results of the test are the same whether or not the Area is logged. I reject the null hypothesis in both cases. The logged data seems to be the more reliable data. The diagnostic plots looks really good when the data is logged. In both cases, the $p$-value is signficant for the interaction. 